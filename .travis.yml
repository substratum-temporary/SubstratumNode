
branches:
  only:
    - master

language: rust
rust:
  - stable

sudo: true

cache:
  directories:
    - node/release/build
    - node/release/deps
    - node/release/examples
    - node/release/incremental
    - node/release/native
    - dns_utility/release/build
    - dns_utility/release/deps
    - dns_utility/release/examples
    - dns_utility/release/incremental
    - dns_utility/release/native
    - port_exposer
    - node-ui/node_modules

before_install:
  - |
    curl -sL https://deb.nodesource.com/setup_10.x | bash -
    sudo apt-get install -y nodejs
    curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
    echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
    sudo apt-get update && sudo apt-get install -y yarn

install:
  - rustup component add rustfmt
  - rustup component add clippy

script: ci/all.sh && ci/multinode_integration_test.sh
